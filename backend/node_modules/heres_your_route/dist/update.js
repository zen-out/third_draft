const { see } = require("code_clarity")
const { upset } = require("whats_wrong")
const express = require("express")
const noobs = require("backend_for_noobs")
const router = express.Router()

const { knex } = require("./knex")

router.put("/api/user/:user_id/problem/", async(req, res, next) => {
    let id = parseInt(req.body.problem_id)
    let user_id = parseInt(req.params.user_id)
    try {
        req.body.edit = new Date()
        results = await noobs.updateProblem(knex, user_id, id, req.body)

    } catch (error) {
        res.send(upset("get", "get.js", "should be able to get problems")).status(400)
    }
    res.send(results).status(200)
})


router.put("/api/user/:user_id/cheatsheet/", async(req, res, next) => {
    let id = parseInt(req.body.cheatsheet_id)
    let user_id = parseInt(req.params.user_id)
    try {
        req.body.edit = new Date()
        results = await noobs.updateCheatsheet(knex, user_id, id, req.body)
    } catch (error) {
        res.send(upset("get", "get.js", "should be able to get problems")).status(400)
    }
    res.send(results).status(200)
})



router.put("/api/user/:user_id/task/", async(req, res, next) => {
    let id = parseInt(req.body.task_id)
    let user_id = parseInt(req.params.user_id)
    try {
        req.body.edit = new Date()
        results = await noobs.updateTask(knex, user_id, id, req.body)
    } catch (error) {
        res.send(upset("get", "get.js", "should be able to get problems")).status(400)
    }
    res.send(results).status(200)
})

router.put("/api/user/:user_id/tag_snippet/", async(req, res, next) => {
    let id = parseInt(req.body.tag_snippet_id)
    let user_id = parseInt(req.params.user_id)
    try {
        req.body.edit = new Date()
        results = await noobs.updateTagSnippet(knex, user_id, id, req.body)
    } catch (error) {
        res.send(upset("get", "get.js", "should be able to get problems")).status(400)
    }
    res.send(results).status(200)
})



module.exports = router